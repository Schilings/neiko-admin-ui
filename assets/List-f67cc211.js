import{_,h as j,a as q,w as ye,p as W,e as ue,P as Te,f as ie,k as Ee}from"./useConfigInject-4e7e38f3.js";import{R as $e}from"./index-86e42ee6.js";import{a as M,ai as we,d as ce,L as ee,R as B,N as L,O as ve,a0 as fe,K as N,a2 as ae,m as xe,_ as X,l as _e,S as Le}from"./runtime-core.esm-bundler-e620233b.js";import{w as k}from"./wave-9bd9da2d.js";import{s as F}from"./KeyCode-e7009ae3.js";function le(){var r=function e(t){e.current=t};return r}var G=function(e,t){var i,n=e.height,s=e.offset,a=e.prefixCls,v=e.onInnerResize,u=t.slots,d={},l={display:"flex",flexDirection:"column"};return s!==void 0&&(d={height:"".concat(n,"px"),position:"relative",overflow:"hidden"},l=_(_({},l),{},{transform:"translateY(".concat(s,"px)"),position:"absolute",left:0,right:0,top:0})),M("div",{style:d},[M($e,{onResize:function(f){var g=f.offsetHeight;g&&v&&v()}},{default:function(){return[M("div",{style:l,class:j(q({},"".concat(a,"-holder-inner"),a))},[(i=u.default)===null||i===void 0?void 0:i.call(u)])]}})])};G.displayName="Filter";G.inheritAttrs=!1;G.props={prefixCls:String,height:Number,offset:Number,onInnerResize:Function};const Fe=G;var he=function(e,t){var i,n=e.setRef,s=t.slots,a=ye((i=s.default)===null||i===void 0?void 0:i.call(s));return a&&a.length?we(a[0],{ref:n}):a};he.props={setRef:{type:Function,default:function(){}}};const Ce=he;var De=20;function se(r){return"touches"in r?r.touches[0].pageY:r.pageY}const Ie=ce({compatConfig:{MODE:3},name:"ScrollBar",inheritAttrs:!1,props:{prefixCls:String,scrollTop:Number,scrollHeight:Number,height:Number,count:Number,onScroll:{type:Function},onStartMove:{type:Function},onStopMove:{type:Function}},setup:function(){return{moveRaf:null,scrollbarRef:le(),thumbRef:le(),visibleTimeout:null,state:ee({dragging:!1,pageY:null,startTop:null,visible:!1})}},watch:{scrollTop:{handler:function(){this.delayHidden()},flush:"post"}},mounted:function(){var e,t;(e=this.scrollbarRef.current)===null||e===void 0||e.addEventListener("touchstart",this.onScrollbarTouchStart,F?{passive:!1}:!1),(t=this.thumbRef.current)===null||t===void 0||t.addEventListener("touchstart",this.onMouseDown,F?{passive:!1}:!1)},beforeUnmount:function(){this.removeEvents(),clearTimeout(this.visibleTimeout)},methods:{delayHidden:function(){var e=this;clearTimeout(this.visibleTimeout),this.state.visible=!0,this.visibleTimeout=setTimeout(function(){e.state.visible=!1},2e3)},onScrollbarTouchStart:function(e){e.preventDefault()},onContainerMouseDown:function(e){e.stopPropagation(),e.preventDefault()},patchEvents:function(){window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp),this.thumbRef.current.addEventListener("touchmove",this.onMouseMove,F?{passive:!1}:!1),this.thumbRef.current.addEventListener("touchend",this.onMouseUp)},removeEvents:function(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),this.scrollbarRef.current.removeEventListener("touchstart",this.onScrollbarTouchStart,F?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchstart",this.onMouseDown,F?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchmove",this.onMouseMove,F?{passive:!1}:!1),this.thumbRef.current.removeEventListener("touchend",this.onMouseUp),k.cancel(this.moveRaf)},onMouseDown:function(e){var t=this.$props.onStartMove;W(this.state,{dragging:!0,pageY:se(e),startTop:this.getTop()}),t(),this.patchEvents(),e.stopPropagation(),e.preventDefault()},onMouseMove:function(e){var t=this.state,i=t.dragging,n=t.pageY,s=t.startTop,a=this.$props.onScroll;if(k.cancel(this.moveRaf),i){var v=se(e)-n,u=s+v,d=this.getEnableScrollRange(),l=this.getEnableHeightRange(),h=l?u/l:0,f=Math.ceil(h*d);this.moveRaf=k(function(){a(f)})}},onMouseUp:function(){var e=this.$props.onStopMove;this.state.dragging=!1,e(),this.removeEvents()},getSpinHeight:function(){var e=this.$props,t=e.height,i=e.count,n=t/i*10;return n=Math.max(n,De),n=Math.min(n,t/2),Math.floor(n)},getEnableScrollRange:function(){var e=this.$props,t=e.scrollHeight,i=e.height;return t-i||0},getEnableHeightRange:function(){var e=this.$props.height,t=this.getSpinHeight();return e-t||0},getTop:function(){var e=this.$props.scrollTop,t=this.getEnableScrollRange(),i=this.getEnableHeightRange();if(e===0||t===0)return 0;var n=e/t;return n*i},showScroll:function(){var e=this.$props,t=e.height,i=e.scrollHeight;return i>t}},render:function(){var e=this.state,t=e.dragging,i=e.visible,n=this.$props.prefixCls,s=this.getSpinHeight()+"px",a=this.getTop()+"px",v=this.showScroll(),u=v&&i;return M("div",{ref:this.scrollbarRef,class:j("".concat(n,"-scrollbar"),q({},"".concat(n,"-scrollbar-show"),v)),style:{width:"8px",top:0,bottom:0,right:0,position:"absolute",display:u?void 0:"none"},onMousedown:this.onContainerMouseDown,onMousemove:this.delayHidden},[M("div",{ref:this.thumbRef,class:j("".concat(n,"-scrollbar-thumb"),q({},"".concat(n,"-scrollbar-thumb-moving"),t)),style:{width:"100%",height:s,top:a,left:0,position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:"99px",cursor:"pointer",userSelect:"none"},onMousedown:this.onMouseDown},null)])}});function Ne(r,e,t,i){var n=new Map,s=new Map,a=B(Symbol("update"));L(r,function(){a.value=Symbol("update")});var v=0;function u(){v+=1;var l=v;Promise.resolve().then(function(){l===v&&n.forEach(function(h,f){if(h&&h.offsetParent){var g=h.offsetHeight;s.get(f)!==g&&(a.value=Symbol("update"),s.set(f,h.offsetHeight))}})})}function d(l,h){var f=e(l),g=n.get(f);h?(n.set(f,h.$el||h),u()):n.delete(f),!g!=!h&&(h?t==null||t(l):i==null||i(l))}return[d,u,s,a]}function ke(r,e,t,i,n,s,a,v){var u;return function(d){if(d==null){v();return}k.cancel(u);var l=e.value,h=i.itemHeight;if(typeof d=="number")a(d);else if(d&&ue(d)==="object"){var f,g=d.align;"index"in d?f=d.index:f=l.findIndex(function(b){return n(b)===d.key});var H=d.offset,p=H===void 0?0:H,P=function b(U,C){if(!(U<0||!r.value)){var E=r.value.clientHeight,O=!1,S=C;if(E){for(var R=C||g,$=0,w=0,y=0,D=Math.min(l.length,f),T=0;T<=D;T+=1){var A=n(l[T]);w=$;var V=t.get(A);y=w+(V===void 0?h:V),$=y,T===f&&V===void 0&&(O=!0)}var Y=r.value.scrollTop,x=null;switch(R){case"top":x=w-p;break;case"bottom":x=y-E+p;break;default:{var z=Y+E;w<Y?S="top":y>z&&(S="bottom")}}x!==null&&x!==Y&&a(x)}u=k(function(){O&&s(),b(U-1,S)})}};P(5)}}}var Pe=(typeof navigator>"u"?"undefined":ue(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const Ue=Pe,de=function(r,e){var t=!1,i=null;function n(){clearTimeout(i),t=!0,i=setTimeout(function(){t=!1},50)}return function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,v=s<0&&r.value||s>0&&e.value;return a&&v?(clearTimeout(i),t=!1):(!v||t)&&n(),!t&&v}};function Oe(r,e,t,i){var n=0,s=null,a=null,v=!1,u=de(e,t);function d(h){if(r.value){k.cancel(s);var f=h.deltaY;n+=f,a=f,!u(f)&&(Ue||h.preventDefault(),s=k(function(){var g=v?10:1;i(n*g),n=0}))}}function l(h){r.value&&(v=h.detail===a)}return[d,l]}var Ve=14/15;function Ye(r,e,t){var i=!1,n=0,s=null,a=null,v=function(){s&&(s.removeEventListener("touchmove",u),s.removeEventListener("touchend",d))},u=function(g){if(i){var H=Math.ceil(g.touches[0].pageY),p=n-H;n=H,t(p)&&g.preventDefault(),clearInterval(a),a=setInterval(function(){p*=Ve,(!t(p,!0)||Math.abs(p)<=.1)&&clearInterval(a)},16)}},d=function(){i=!1,v()},l=function(g){v(),g.touches.length===1&&!i&&(i=!0,n=Math.ceil(g.touches[0].pageY),s=g.target,s.addEventListener("touchmove",u,{passive:!1}),s.addEventListener("touchend",d))},h=function(){};ve(function(){document.addEventListener("touchmove",h,{passive:!1}),L(r,function(f){e.value.removeEventListener("touchstart",l),v(),clearInterval(a),f&&e.value.addEventListener("touchstart",l,{passive:!1})},{immediate:!0})}),fe(function(){document.removeEventListener("touchmove",h)})}var ze=["prefixCls","height","itemHeight","fullHeight","data","itemKey","virtual","component","onScroll","children","style","class"],Ke=[],Be={overflowY:"auto",overflowAnchor:"none"};function Ae(r,e,t,i,n,s){var a=s.getKey;return r.slice(e,t+1).map(function(v,u){var d=e+u,l=n(v,d,{}),h=a(v);return M(Ce,{key:h,setRef:function(g){return i(v,g)}},{default:function(){return[l]}})})}var We=ce({compatConfig:{MODE:3},name:"List",inheritAttrs:!1,props:{prefixCls:String,data:Te.array,height:Number,itemHeight:Number,fullHeight:{type:Boolean,default:void 0},itemKey:{type:[String,Number,Function],required:!0},component:{type:[String,Object]},virtual:{type:Boolean,default:void 0},children:Function,onScroll:Function,onMousedown:Function,onMouseenter:Function,onVisibleChange:Function},setup:function(e,t){var i=t.expose,n=N(function(){var o=e.height,c=e.itemHeight,m=e.virtual;return!!(m!==!1&&o&&c)}),s=N(function(){var o=e.height,c=e.itemHeight,m=e.data;return n.value&&m&&c*m.length>o}),a=ee({scrollTop:0,scrollMoving:!1}),v=N(function(){return e.data||Ke}),u=ae([]);L(v,function(){u.value=xe(v.value).slice()},{immediate:!0});var d=ae(function(o){});L(function(){return e.itemKey},function(o){typeof o=="function"?d.value=o:d.value=function(c){return c==null?void 0:c[o]}},{immediate:!0});var l=B(),h=B(),f=B(),g=function(c){return d.value(c)},H={getKey:g};function p(o){var c;typeof o=="function"?c=o(a.scrollTop):c=o;var m=w(c);l.value&&(l.value.scrollTop=m),a.scrollTop=m}var P=Ne(u,g,null,null),b=ie(P,4),U=b[0],C=b[1],E=b[2],O=b[3],S=ee({scrollHeight:void 0,start:0,end:0,offset:void 0}),R=B(0);ve(function(){X(function(){var o;R.value=((o=h.value)===null||o===void 0?void 0:o.offsetHeight)||0})}),_e(function(){X(function(){var o;R.value=((o=h.value)===null||o===void 0?void 0:o.offsetHeight)||0})}),L([n,u],function(){n.value||W(S,{scrollHeight:void 0,start:0,end:u.value.length-1,offset:void 0})},{immediate:!0}),L([n,u,R,s],function(){n.value&&!s.value&&W(S,{scrollHeight:R.value,start:0,end:u.value.length-1,offset:void 0})},{immediate:!0}),L([s,n,function(){return a.scrollTop},u,O,function(){return e.height},R],function(){if(!(!n.value||!s.value)){for(var o=0,c,m,I,Z=u.value.length,me=u.value,re=a.scrollTop,Se=e.itemHeight,be=e.height,Me=re+be,K=0;K<Z;K+=1){var He=me[K],Re=g(He),J=E.get(Re);J===void 0&&(J=Se);var Q=o+J;c===void 0&&Q>=re&&(c=K,m=o),I===void 0&&Q>Me&&(I=K),o=Q}c===void 0&&(c=0,m=0),I===void 0&&(I=Z-1),I=Math.min(I+1,Z),W(S,{scrollHeight:o,start:c,end:I,offset:m})}},{immediate:!0});var $=N(function(){return S.scrollHeight-e.height});function w(o){var c=o;return Number.isNaN($.value)||(c=Math.min(c,$.value)),c=Math.max(c,0),c}var y=N(function(){return a.scrollTop<=0}),D=N(function(){return a.scrollTop>=$.value}),T=de(y,D);function A(o){var c=o;p(c)}function V(o){var c,m=o.currentTarget.scrollTop;Math.abs(m-a.scrollTop)>=1&&p(m),(c=e.onScroll)===null||c===void 0||c.call(e,o)}var Y=Oe(n,y,D,function(o){p(function(c){var m=c+o;return m})}),x=ie(Y,2),z=x[0],te=x[1];Ye(n,l,function(o,c){return T(o,c)?!1:(z({preventDefault:function(){},deltaY:o}),!0)});function ne(o){n.value&&o.preventDefault()}var oe=function(){l.value&&(l.value.removeEventListener("wheel",z,F?{passive:!1}:!1),l.value.removeEventListener("DOMMouseScroll",te),l.value.removeEventListener("MozMousePixelScroll",ne))};Le(function(){X(function(){l.value&&(oe(),l.value.addEventListener("wheel",z,F?{passive:!1}:!1),l.value.addEventListener("DOMMouseScroll",te),l.value.addEventListener("MozMousePixelScroll",ne))})}),fe(function(){oe()});var ge=ke(l,u,E,e,g,C,p,function(){var o;(o=f.value)===null||o===void 0||o.delayHidden()});i({scrollTo:ge});var pe=N(function(){var o=null;return e.height&&(o=_(q({},e.fullHeight?"height":"maxHeight",e.height+"px"),Be),n.value&&(o.overflowY="hidden",a.scrollMoving&&(o.pointerEvents="none"))),o});return L([function(){return S.start},function(){return S.end},u],function(){if(e.onVisibleChange){var o=u.value.slice(S.start,S.end+1);e.onVisibleChange(o,u.value)}},{flush:"post"}),{state:a,mergedData:u,componentStyle:pe,onFallbackScroll:V,onScrollBar:A,componentRef:l,useVirtual:n,calRes:S,collectHeight:C,setInstance:U,sharedConfig:H,scrollBarRef:f,fillerInnerRef:h}},render:function(){var e=this,t=_(_({},this.$props),this.$attrs),i=t.prefixCls,n=i===void 0?"rc-virtual-list":i,s=t.height;t.itemHeight,t.fullHeight,t.data,t.itemKey,t.virtual;var a=t.component,v=a===void 0?"div":a;t.onScroll;var u=t.children,d=u===void 0?this.$slots.default:u,l=t.style,h=t.class,f=Ee(t,ze),g=j(n,h),H=this.state.scrollTop,p=this.calRes,P=p.scrollHeight,b=p.offset,U=p.start,C=p.end,E=this.componentStyle,O=this.onFallbackScroll,S=this.onScrollBar,R=this.useVirtual,$=this.collectHeight,w=this.sharedConfig,y=this.setInstance,D=this.mergedData;return M("div",_({style:_(_({},l),{},{position:"relative"}),class:g},f),[M(v,{class:"".concat(n,"-holder"),style:E,ref:"componentRef",onScroll:O},{default:function(){return[M(Fe,{prefixCls:n,height:P,offset:b,onInnerResize:$,ref:"fillerInnerRef"},{default:function(){return Ae(D,U,C,y,d,w)}})]}}),R&&M(Ie,{ref:"scrollBarRef",prefixCls:n,scrollTop:H,height:s,scrollHeight:P,count:D.length,onScroll:S,onStartMove:function(){e.state.scrollMoving=!0},onStopMove:function(){e.state.scrollMoving=!1}},null)])}});const Qe=We;export{Qe as L,le as c};
