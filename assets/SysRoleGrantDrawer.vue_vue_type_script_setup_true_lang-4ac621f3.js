/* empty css                */import{D as C}from"./index-67c01fa1.js";/* empty css              */import{B as K}from"./index-cf5fb184.js";import{_ as b}from"./index-4948e659.js";/* empty css              */import{_ as v}from"./index-daa4fc82.js";import{u as w}from"./modal-94b635e5.js";import{j as S,l as B}from"./index-d8cf9b9f.js";import{l as D,a as R}from"./index-2012180d.js";import{d as T,R as I,L as M,o as N,c as L,w as r,a7 as _,a as c,an as P,u as l,a5 as f}from"./runtime-core.esm-bundler-e620233b.js";import{t as V}from"./useConfigInject-4e7e38f3.js";import{S as E}from"./Spin-99a3053a.js";const G={style:{"margin-bottom":"60px"}},j={style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},O={name:"SysRoleGrantDrawer"},te=T({...O,setup(q,{expose:u}){let d="";const{visible:h,openModal:y,closeModal:p}=w(),a=I(!1),t=M({treeData:[],checkedKeys:[],halfCheckedKeys:[],expandedKeys:[],onCheck(e,o){t.checkedKeys=e,t.halfCheckedKeys=o.halfCheckedKeys||[]},onExpand(e){t.expandedKeys=e}});a.value=!0,S().then(e=>{t.treeData=e.data?B(e.data,0):[]}).finally(()=>{a.value=!1});const m=(e,o,s)=>{for(let i=0;i<e.length;i++){const n=e[i];n.children&&n.children.length!==0?m(n.children,o,s):o.indexOf(n.key)!==-1&&s.push(n.key)}return s},g=()=>{const e=new Set(t.checkedKeys),o=new Set(t.halfCheckedKeys),s=[...new Set([...e,...o])];a.value=!0,R(d,s).then(i=>{V.success(i.message),p()}).finally(()=>{a.value=!1})};return u({open(e){y(),d=e.code,a.value=!0,D(d).then(o=>{t.checkedKeys=m(t.treeData,o.data,[]),t.halfCheckedKeys=o.data,t.expandedKeys=o.data}).finally(()=>{a.value=!1})}}),(e,o)=>{const s=v,i=E,n=K,k=b,x=C;return N(),L(x,{title:"角色授权",placement:"right",visible:l(h),width:600,onClose:l(p)},{default:r(()=>[_("div",G,[c(i,{spinning:l(a)},{default:r(()=>[c(s,P({checkable:!0},l(t)),null,16)]),_:1},8,["spinning"])]),_("div",j,[c(k,{title:"确定放弃编辑？","ok-text":"确定","cancel-text":"取消",onConfirm:l(p)},{default:r(()=>[c(n,{style:{"margin-right":"0.8rem"}},{default:r(()=>[f("取消")]),_:1})]),_:1},8,["onConfirm"]),c(n,{type:"primary",loading:l(a),onClick:g},{default:r(()=>[f("保存")]),_:1},8,["loading"])])]),_:1},8,["visible","onClose"])}}});export{te as _};
